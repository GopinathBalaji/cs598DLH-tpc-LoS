2024-04-12 12:12:00,821 - INFO - Config:
2024-04-12 12:12:00,821 - INFO - {
    "L2_regularisation": 0,
    "alpha": 100,
    "base_dir": "models/experiments/MIMIC/LoS/LSTM",
    "batch_size": 512,
    "batch_size_test": 32,
    "batchnorm": "mybatchnorm",
    "bidirectional": false,
    "channelwise": false,
    "dataset": "MIMIC",
    "diagnosis_size": 64,
    "disable_cuda": false,
    "exp_name": "LSTM",
    "hidden_size": 128,
    "intermediate_reporting": false,
    "labs_only": false,
    "last_linear_size": 17,
    "learning_rate": 0.00129,
    "loss": "msle",
    "lstm_dropout_rate": 0.2,
    "main_dropout_rate": 0.45,
    "mode": "train",
    "n_epochs": 8,
    "n_layers": 2,
    "name": "LSTM",
    "no_diag": true,
    "no_exp": false,
    "no_labs": false,
    "no_mask": false,
    "percentage_data": 100.0,
    "save_results_csv": true,
    "seed": 3956582864,
    "shuffle_train": false,
    "sum_losses": true,
    "task": "LoS"
}
2024-04-12 12:12:01,146 - INFO - Experiment set up.
2024-04-12 12:12:03,236 - INFO - BaseLSTM(
  (relu): ReLU()
  (sigmoid): Sigmoid()
  (hardtanh): Hardtanh(min_val=0.020833333333333332, max_val=100)
  (lstm_dropout): Dropout(p=0.2, inplace=False)
  (main_dropout): Dropout(p=0.45, inplace=False)
  (msle_loss): MSLELoss(
    (squared_error): MSELoss()
  )
  (mse_loss): MSELoss(
    (squared_error): MSELoss()
  )
  (bce_loss): BCELoss()
  (empty_module): EmptyModule()
  (lstm): LSTM(204, 128, num_layers=2, dropout=0.2)
  (diagnosis_encoder): Linear(in_features=1, out_features=64, bias=True)
  (bn_diagnosis_encoder): MyBatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_los): Linear(in_features=161, out_features=17, bias=True)
  (point_mort): Linear(in_features=161, out_features=17, bias=True)
  (bn_point_last_los): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_mort): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_final_los): Linear(in_features=17, out_features=1, bias=True)
  (point_final_mort): Linear(in_features=17, out_features=1, bias=True)
)
2024-04-12 12:24:52,933 - INFO - Custom bins confusion matrix:
2024-04-12 12:24:52,933 - INFO - [[249019 516082 107105  41344  20228  10902   6756   4299   9397   3426]
 [101915 316609  97632  44140  23621  14007   9099   5938  13609   5013]
 [ 47292 188966  73567  36910  21200  13289   8936   6060  14538   5655]
 [ 25567 122532  55391  30243  18208  11808   8307   5664  14215   5848]
 [ 15809  85141  43349  24621  15568  10418   7293   5280  13148   5574]
 [ 10556  62963  34579  20188  12953   8957   6257   4628  12148   5446]
 [  7569  47737  28387  17295  11443   7719   5741   4205  11160   5141]
 [  5409  38005  23658  14636   9695   6838   4972   3675  10099   4845]
 [ 14558 119158  82030  54111  37495  27211  20117  15200  42520  21255]
 [  8196  84925  70559  51390  37467  27892  21432  16535  48108  27153]]
2024-04-12 12:24:57,721 - INFO - Epoch: 0 | Train Loss: 137.9629
2024-04-12 12:26:57,165 - INFO - Custom bins confusion matrix:
2024-04-12 12:26:57,165 - INFO - [[58334 97391 32799 13197  4606  1892   728   266   127     0]
 [19606 59168 30312 16011  7109  3339  1365   509   221     0]
 [ 7735 32322 22405 14768  7595  3813  1785   613   311     5]
 [ 3567 19457 16034 12186  7004  4004  1754   645   320    16]
 [ 1854 12375 11913  9662  6279  3631  1673   641   324     0]
 [ 1015  7990  8801  7883  5628  3119  1528   471   354     0]
 [  694  5862  6901  5933  4605  2989  1381   431   336     0]
 [  477  4257  5545  5162  3960  2670  1373   334   380     0]
 [  864 11578 18034 20119 15766 10968  5582  2183  1536     0]
 [  966  5799 11227 15247 15224 11602  5782  3259  2854    81]]
2024-04-12 12:26:58,821 - INFO - Epoch: 0 | Validation Loss: 111.3905
2024-04-12 12:39:46,242 - INFO - Custom bins confusion matrix:
2024-04-12 12:39:46,242 - INFO - [[354925 421352 105378  41191  18896   9993   5702   3386   6224   1511]
 [126792 270745 109196  51845  27056  15675   9334   6017  11910   3013]
 [ 52963 157294  84129  45145  25601  15761   9973   6819  14575   4153]
 [ 25164  99633  63189  37122  22479  14241   9597   6514  15028   4816]
 [ 13941  66951  48937  30417  19007  12741   8570   6199  14498   4940]
 [  8395  47639  38569  25467  16157  10965   7738   5481  13475   4789]
 [  5867  35255  30819  21415  14030   9673   6956   4891  12621   4870]
 [  3938  27318  25424  18081  11862   8712   6080   4495  11410   4512]
 [ 10096  80156  84724  65706  45734  33695  25156  18250  49417  20721]
 [  5099  51580  67378  58969  44037  33621  26289  19960  56630  30094]]
2024-04-12 12:39:50,694 - INFO - Epoch: 1 | Train Loss: 119.9847
2024-04-12 12:41:48,297 - INFO - Custom bins confusion matrix:
2024-04-12 12:41:48,297 - INFO - [[82155 78990 25433 12519  5620  2486  1109   555   473     0]
 [28415 51933 25300 14910  8232  4503  2329  1116   902     0]
 [11299 29165 18096 13657  8230  5171  2977  1406  1338    13]
 [ 5283 18210 12795 10542  7240  4662  3095  1624  1497    39]
 [ 2772 11375  9449  8264  6184  4513  2587  1644  1556     8]
 [ 1554  7259  6685  6605  5397  4032  2467  1506  1275     9]
 [ 1116  5301  5014  5261  4128  3226  2464  1349  1270     3]
 [  804  3815  4085  4337  3592  2956  2169  1180  1206    14]
 [ 1556 10181 13059 15951 14631 11815  8434  5188  5727    88]
 [ 1379  4664  8405 10915 12271 10385  9192  5866  8797   167]]
2024-04-12 12:41:50,009 - INFO - Epoch: 1 | Validation Loss: 105.1652
2024-04-12 12:54:38,507 - INFO - Custom bins confusion matrix:
2024-04-12 12:54:38,517 - INFO - [[383042 400524 101512  39608  18324   9378   5425   3300   6034   1411]
 [132324 262767 111476  52373  27337  15597   9339   6023  11614   2733]
 [ 53883 150979  86494  46869  26302  16313  10333   6751  14537   3952]
 [ 24899  93869  65118  38973  23421  14861   9916   6833  15229   4664]
 [ 13451  62397  49710  31874  19670  13333   9108   6559  15170   4929]
 [  8051  43420  38697  26793  17129  11695   8031   5712  14253   4894]
 [  5529  31718  31070  22259  14747  10461   7371   5298  13199   4745]
 [  3811  24192  25686  18793  12334   8992   6570   4688  12022   4744]
 [  9941  70069  82449  67055  47692  35442  26713  19925  52092  22277]
 [  5171  42158  64514  58721  45104  34645  27501  21398  61343  33102]]
2024-04-12 12:54:43,024 - INFO - Epoch: 2 | Train Loss: 114.8517
2024-04-12 12:56:40,873 - INFO - Custom bins confusion matrix:
2024-04-12 12:56:40,888 - INFO - [[96082 70238 22090 11162  5169  2320  1092   613   574     0]
 [34170 49860 23340 13572  7654  4393  2302  1227  1099    23]
 [13898 28843 16957 12425  8182  4898  3042  1498  1586    23]
 [ 6469 18586 11804  9660  7126  4594  2998  1835  1868    47]
 [ 3435 11721  8883  7746  5912  4234  2770  1623  2001    27]
 [ 2098  7525  6259  6134  4985  3963  2607  1516  1672    30]
 [ 1390  5599  4638  4911  3960  3027  2461  1515  1618    13]
 [ 1039  4039  3874  3955  3456  2731  2251  1368  1398    47]
 [ 2178 10716 12281 14903 13621 11458  8730  5619  6930   194]
 [ 1664  5204  7904  9999 11291 10304  8415  6366 10706   188]]
2024-04-12 12:56:42,645 - INFO - Epoch: 2 | Validation Loss: 103.0196
2024-04-12 13:09:29,975 - INFO - Custom bins confusion matrix:
2024-04-12 13:09:29,975 - INFO - [[391561 397225  99690  37875  17567   8975   5255   3242   5875   1293]
 [132886 261806 112644  52404  27271  15537   9228   5773  11338   2696]
 [ 52810 149028  88182  47430  27112  16433  10430   6913  14253   3822]
 [ 23949  91716  66052  39439  23839  15586  10339   7009  15365   4489]
 [ 12879  59626  50417  32205  20788  13859   9465   6478  15656   4828]
 [  7641  40957  39043  27176  17802  12250   8524   5921  14473   4888]
 [  5287  29583  31325  22803  15249  10696   7670   5411  13463   4910]
 [  3570  22489  25649  18875  12895   9291   6760   4891  12577   4835]
 [  9348  63282  82181  67322  49008  36517  27374  20698  54704  23221]
 [  4844  35580  62289  57338  47382  35363  28484  22660  64205  35512]]
2024-04-12 13:09:34,396 - INFO - Epoch: 3 | Train Loss: 111.2939
2024-04-12 13:11:31,809 - INFO - Custom bins confusion matrix:
2024-04-12 13:11:31,809 - INFO - [[94221 72319 21678 10395  5497  2498  1177   739   815     1]
 [32793 50814 22952 13235  7699  4514  2616  1453  1511    53]
 [13191 29106 16557 11915  8302  5204  3193  1779  2038    67]
 [ 6054 18641 11457  9151  7197  4758  3175  2100  2383    71]
 [ 3240 11580  8466  7472  5876  4337  2917  1914  2507    43]
 [ 1987  7375  6088  5682  4879  4006  2774  1816  2115    67]
 [ 1317  5502  4399  4516  3956  3172  2451  1684  2103    32]
 [  937  3964  3752  3567  3405  2746  2405  1534  1780    68]
 [ 2114 10481 11606 13385 13091 11295  9395  6372  8529   362]
 [ 1620  5178  7352  8677 10649 10293  8446  6923 12541   362]]
2024-04-12 13:11:33,528 - INFO - Epoch: 3 | Validation Loss: 101.7486
2024-04-12 13:24:19,608 - INFO - Custom bins confusion matrix:
2024-04-12 13:24:19,608 - INFO - [[396721 396849  97819  36939  16663   8499   5040   3036   5640   1352]
 [133282 261862 112782  52646  27071  15343   9347   5685  11078   2487]
 [ 52160 147913  89034  47847  27291  16779  10330   6914  14363   3782]
 [ 23119  89848  66971  39965  24273  15775  10491   7211  15613   4517]
 [ 12274  58250  50199  33352  20984  14391   9742   6590  15582   4837]
 [  7396  38831  39279  27413  18150  12697   8843   6354  14854   4858]
 [  5008  27942  30981  22907  15872  11055   7959   5650  14067   4956]
 [  3427  20931  25502  19045  13472   9525   7022   5180  12808   4920]
 [  8979  57240  80494  67405  50979  37578  28346  21417  56804  24413]
 [  4544  30757  58974  55724  47861  36573  29386  23752  68242  37844]]
2024-04-12 13:24:24,008 - INFO - Epoch: 4 | Train Loss: 108.1235
2024-04-12 13:26:21,861 - INFO - Custom bins confusion matrix:
2024-04-12 13:26:21,861 - INFO - [[94006 73309 20864  9627  5596  2807  1417   699  1006     9]
 [32812 51293 21963 12785  7763  4779  2792  1641  1748    64]
 [13172 29401 15897 11323  8194  5428  3437  2078  2331    91]
 [ 6198 18651 10922  8617  7284  4841  3383  2284  2705   102]
 [ 3309 11579  8256  6767  6042  4314  3102  2105  2807    71]
 [ 1974  7466  5808  5384  4765  3978  2982  1926  2435    71]
 [ 1305  5600  4214  4331  3791  3111  2530  1774  2429    47]
 [  917  3967  3692  3476  3157  2741  2481  1593  2055    79]
 [ 2214 10507 11019 12467 12708 11340  9444  6703  9776   452]
 [ 1646  5329  6820  7984  9700 10427  8842  6995 13607   691]]
2024-04-12 13:26:23,618 - INFO - Epoch: 4 | Validation Loss: 101.1413
2024-04-12 13:39:00,345 - INFO - Custom bins confusion matrix:
2024-04-12 13:39:00,345 - INFO - [[399464 398841  96872  34465  15904   8421   4851   2942   5484   1314]
 [134080 261845 113929  51843  26898  14856   9007   5848  10878   2399]
 [ 51746 147252  89531  48154  27465  16760  10697   6986  14214   3608]
 [ 22807  88851  66925  40381  25147  15978  10588   7179  15541   4386]
 [ 12135  56751  50230  33180  21768  14564  10078   6836  15758   4901]
 [  7217  37729  39203  27379  18687  12944   9223   6527  14932   4834]
 [  4844  26689  30721  22974  16123  11343   8289   5968  14419   5027]
 [  3224  19921  24835  19147  13906   9940   7196   5413  13238   5012]
 [  8529  52832  79104  66558  52287  38347  29525  22377  59245  24851]
 [  4295  27291  54935  53559  48998  37570  30069  24734  71982  40224]]
2024-04-12 13:39:04,773 - INFO - Epoch: 5 | Train Loss: 105.3664
2024-04-12 13:41:02,216 - INFO - Custom bins confusion matrix:
2024-04-12 13:41:02,216 - INFO - [[92504 73208 21695  9620  5481  3051  1659   850  1248    24]
 [31863 50433 22240 12657  7968  5275  3177  1766  2167    94]
 [12838 28535 15814 11068  8093  5856  3793  2300  2925   130]
 [ 6101 17884 10975  8170  7243  5189  3478  2501  3305   141]
 [ 3277 11137  7985  6307  6280  4440  3363  2196  3282    85]
 [ 1947  7120  5668  5162  4682  4128  3128  2029  2834    91]
 [ 1287  5412  4037  4034  3861  3144  2603  1846  2826    82]
 [  871  3930  3428  3455  2920  2750  2589  1733  2388    94]
 [ 2159 10501 10149 11325 12245 11205  9916  7280 11295   555]
 [ 1598  5567  6205  7128  9121  9963  9211  7475 14990   783]]
2024-04-12 13:41:04,002 - INFO - Epoch: 5 | Validation Loss: 101.1748
2024-04-12 13:53:41,810 - INFO - Custom bins confusion matrix:
2024-04-12 13:53:41,810 - INFO - [[403777 397600  96574  33159  15279   8028   4563   2902   5359   1317]
 [134916 261052 115538  51155  26642  14785   8908   5677  10475   2435]
 [ 51841 145664  90681  48445  27622  16873  10711   6926  14014   3636]
 [ 22533  87216  67770  41041  25297  16111  10933   7079  15526   4277]
 [ 11914  55296  50894  33513  22133  14680  10264   7118  15758   4631]
 [  7080  36249  39406  27810  19201  13037   9239   6487  15210   4956]
 [  4677  25330  30933  22947  16726  11722   8292   6139  14609   5022]
 [  3167  18440  25268  18927  14166  10032   7574   5523  13647   5088]
 [  8196  49415  77188  65128  54091  39111  30219  23169  60871  26267]
 [  4115  24115  50937  51402  49480  38631  30451  25207  75414  43905]]
2024-04-12 13:53:46,248 - INFO - Epoch: 6 | Train Loss: 103.0332
2024-04-12 13:55:43,213 - INFO - Custom bins confusion matrix:
2024-04-12 13:55:43,213 - INFO - [[96707 71348 20910  9082  4964  2677  1540   975  1061    76]
 [34007 49950 21781 12624  7756  4889  2846  1705  1990    92]
 [13847 28522 15890 10870  8087  5475  3652  2263  2628   118]
 [ 6740 17829 11125  8189  7209  5026  3381  2440  2914   134]
 [ 3565 11388  8207  6340  6086  4466  3243  2068  2897    92]
 [ 2189  7336  5931  4956  4760  4108  3057  1934  2431    87]
 [ 1450  5614  4141  4105  3870  3006  2570  1784  2527    65]
 [  976  4164  3600  3432  2843  2760  2347  1732  2211    93]
 [ 2627 10890 10992 11107 12133 11303  9578  6996 10500   504]
 [ 1760  6096  6529  7123  9391  9516  9097  7030 14613   886]]
2024-04-12 13:55:44,922 - INFO - Epoch: 6 | Validation Loss: 101.1087
2024-04-12 14:08:25,757 - INFO - Custom bins confusion matrix:
2024-04-12 14:08:25,757 - INFO - [[410284 395274  94901  32152  14702   7704   4407   2805   5129   1200]
 [136952 260051 116198  50940  26164  14555   8897   5307  10161   2358]
 [ 51755 145155  91186  48832  28117  16824  10611   6944  13496   3493]
 [ 22434  85485  68443  41947  25872  16295  10658   7198  15290   4161]
 [ 11743  53622  50608  34303  22646  15530  10288   7056  15771   4634]
 [  6963  34596  39347  28119  19770  13719   9407   6561  15335   4858]
 [  4696  24080  30311  23324  17007  12169   8653   6209  14872   5076]
 [  3152  17463  24404  19460  14549  10238   7706   5605  13972   5283]
 [  7921  45384  73875  65914  54557  40724  30571  24067  63117  27525]
 [  3780  21472  46115  49578  48142  39996  31382  25884  78994  48314]]
2024-04-12 14:08:30,241 - INFO - Epoch: 7 | Train Loss: 100.5437
2024-04-12 14:10:43,581 - INFO - Custom bins confusion matrix:
2024-04-12 14:10:43,581 - INFO - [[99021 71973 19194  7922  4721  2667  1441   885  1417    99]
 [35031 50807 20740 11594  7433  5016  2792  1733  2303   191]
 [14423 29407 14843 10140  7704  5543  3657  2368  3050   217]
 [ 7056 18459 10725  7434  6777  4917  3554  2444  3422   199]
 [ 3799 12067  7556  5622  5992  4479  3216  2253  3245   123]
 [ 2371  7829  5476  4434  4609  4059  2961  2104  2830   116]
 [ 1517  5908  3927  3669  3698  3074  2495  1870  2831   143]
 [ 1007  4445  3491  3180  2589  2459  2504  1804  2535   144]
 [ 3037 11577 10429  9794 11168 11119  9242  7194 12403   667]
 [ 1890  6653  5948  6505  8967  8997  8749  7213 16046  1073]]
2024-04-12 14:10:45,307 - INFO - Epoch: 7 | Validation Loss: 101.2921
2024-04-12 14:10:48,610 - INFO - Experiment ended. Checkpoints stored =)
